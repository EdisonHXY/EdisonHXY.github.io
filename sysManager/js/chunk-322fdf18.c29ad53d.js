(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-322fdf18"],{c740:function(e,t,a){"use strict";var i=a("23e7"),l=a("b727").findIndex,r=a("44d2"),n="findIndex",s=!0;n in[]&&Array(1)[n]((function(){s=!1})),i({target:"Array",proto:!0,forced:s},{findIndex:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}}),r(n)},d2c9:function(e,t,a){},d7af:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{center:"",title:e.dialog.title,visible:e.dialog.visible,width:"20%"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[a("span",[e._v(e._s(e.dialog.tipMsg))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.visible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.dialogOkClick}},[e._v("确 定")])],1)])],1)},l=[],r={props:{dialog:{visible:!1,title:"提示",tipMsg:"",trsfParm:{}}},methods:{dialogOkClick:function(){this.dialog.visible=!1,this.$emit("okClick",this.dialog.trsfParm)}}},n=r,s=a("2877"),o=Object(s["a"])(n,i,l,!1,null,null,null);t["a"]=o.exports},dd50:function(e,t,a){"use strict";a("d2c9")},de56:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{staticClass:"borderDes",attrs:{span:13}},[a("h4",{staticStyle:{"margin-left":"20px"}},[e._v("直播通道列表")]),a("div",{staticStyle:{"margin-right":"20px","margin-left":"20px"}},[a("el-form",{ref:"formName",attrs:{inline:!0,model:e.form,rules:e.relu}},[a("el-form-item",{attrs:{label:"通道名",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{staticStyle:{"padding-left":"20px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.live_add}},[e._v("增加")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",disabled:e.btnDisable.liveBtn.reName},on:{click:e.live_reName}},[e._v("更名")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:e.btnDisable.liveBtn.del},on:{click:e.live_del}},[e._v("删除")]),a("el-button",{attrs:{type:"warning",disabled:e.btnDisable.liveBtn.init},on:{click:e.live_ini}},[e._v("初始化")]),a("el-button",{attrs:{type:"success",disabled:e.btnDisable.liveBtn.save},on:{click:e.live_save}},[e._v("保存")])],1)],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:5}},[a("div",{staticClass:"treeDes",staticStyle:{"margin-right":"5px"}},[a("el-tree",{ref:"tree",attrs:{"default-expand-all":"","node-key":"id","expand-on-click-node":!1,"highlight-current":!0,data:e.treeData},on:{"node-click":e.clickTreeFunc}})],1)]),a("el-col",{attrs:{span:19}},[a("div",[a("edit-table",{ref:"liveTb",attrs:{table_ui_data:e.liveInfoUI,table_data:e.liveInfoTableData,table_disable_edit:!1},on:{dataChanged:e.liveTbChanged}})],1)])],1)],1)]),a("el-col",{staticClass:"borderDes",attrs:{span:10}},[a("h4",{staticStyle:{"margin-left":"20px"}},[e._v("直播服务器列表")]),a("div",{staticStyle:{"margin-right":"20px","margin-left":"20px"}},[a("el-button",{attrs:{type:"warning"},on:{click:e.server_ini}},[e._v("初始化")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.server_add}},[e._v("增加")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:e.btnDisable.serverBtn.del},on:{click:e.server_del}},[e._v("删除")]),a("el-button",{attrs:{type:"success",disabled:e.btnDisable.serverBtn.save},on:{click:e.server_save}},[e._v("保存")]),a("edit-table",{ref:"serverTb",staticStyle:{"margin-top":"20px"},attrs:{table_ui_data:e.liveListUI,table_data:e.liveListTableData,table_disable_edit:!1},on:{dataChanged:e.serverTbChaned,rowClick:e.serverRowClick}})],1)])],1),a("tip-dialog",{attrs:{dialog:e.dialog},on:{okClick:e.dialogOkClick}})],1)},l=[],r=(a("c740"),a("a434"),a("b0c0"),a("159b"),a("d7af")),n=a("5c96"),s=1e3,o={components:{tipDialog:r["a"]},data:function(){return{liveListUI:[{label:"线路",prop:"id",disabled:!0},{label:"服务器地址",prop:"address"},{label:"端口",prop:"port"},{label:"延迟(秒)",prop:"delay"}],liveListTableData:[],liveInfoTableData:[],liveInfoUI:[{label:"线路",prop:"id",disabled:!0},{label:"组播地址",prop:"address"},{label:"端口",prop:"port",width:60},{label:"车载组播地址",prop:"address_train"},{label:"车载端口",prop:"port_train",width:60},{label:"源地址",prop:"src"},{label:"源端口",prop:"src_port",width:60},{label:"包大小",prop:"package_size",width:60},{label:"是否缓冲",prop:"is_buffer",width:50}],treeData:[{id:0,label:"视频直播通道",children:[]}],form:{name:""},relu:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]},btnDisable:{liveBtn:{reName:!0,del:!0,init:!0,save:!0},serverBtn:{del:!0,save:!0}},treeCurrent:{},dialog:{visible:!1,title:"提示",tipMsg:"",trsfParm:{}},lineList:[]}},methods:{dialogOkClick:function(e){var t=this;if(1==e.num){var a={name:this.treeCurrent.label};this.$httpApi.live_del(a).then((function(e){if("0"==e.data.code){var a=t.treeData[0].children,i=a.findIndex((function(e){return e.id===t.treeCurrent.id}));a.splice(i,1),t.liveInfoTableData=[],t.$refs.liveTb.initCurrentData(t.liveInfoTableData),a.length<=0&&(t.btnDisable.liveBtn.init=t.btnDisable.liveBtn.del=t.btnDisable.liveBtn.reName=!0)}else n["Message"].error(e.data.message)}))}else if(2==e.num){var i={old_name:this.treeCurrent.label,new_name:t.form.name};this.$httpApi.live_rename(i).then((function(e){"0"==e.data.code?t.treeCurrent&&t.form.name.length>0&&(t.treeCurrent.label=t.form.name):n["Message"].error(e.data.message)}))}},live_add:function(){var e=this;this.$refs.formName.validate((function(t){if(t){var a={id:s++,label:e.form.name,children:[]};e.treeData[0].children.push(a)}}))},live_reName:function(){this.dialog.tipMsg="是否更改 "+this.treeCurrent.label+" 为 "+this.form.name+"?",this.dialog.trsfParm.num=2,this.dialog.visible=!0},live_del:function(){this.dialog.tipMsg="是否删除通道 "+this.treeCurrent.label+"?",this.dialog.trsfParm.num=1,this.dialog.visible=!0},live_ini:function(){var e=this;this.liveInfoTableData=new Array,this.lineList.forEach((function(t){var a={id:t.id,address:"224.3.1.50",port:"7660",address_train:"224.3.1.50",port_train:"7661",src:"224.3.0.1",src_port:"1234",package_size:"1316",is_buffer:"0"};e.liveInfoTableData.push(a)}))},live_save:function(){var e=this;console.log("列表执行"),this.$refs.liveTb.confirmOKAction((function(t,a){var i=JSON.parse(JSON.stringify(t));i.name=e.treeCurrent.label,1==a?(console.log("add"),e.$httpApi.live_add(i).then((function(e){"0"!=e.data.code&&n["Message"].error(e.data.message)}))):2==a?(console.log("upda"),e.$httpApi.live_update(i).then((function(e){"0"!=e.data.code&&n["Message"].error(e.data.message)}))):3==a&&(console.log("del"),e.$httpApi.live_del(i).then((function(e){"0"!=e.data.code&&n["Message"].error(e.data.message)})))}))},server_add:function(){},server_ini:function(){var e=this;this.liveListTableData=new Array;var t=10;this.lineList.forEach((function(a){var i={id:a.id,address:"10.0.50."+t++,port:"7670",delay:"60"};e.liveListTableData.push(i)}))},server_del:function(){this.$refs.serverTb.deleteAction()},server_save:function(){var e=this;this.$refs.serverTb.confirmOKAction((function(t,a){var i=JSON.parse(JSON.stringify(t));1==a?(console.log("add"),e.$httpApi.live_server_add(i).then((function(e){"0"!=e.data.code&&n["Message"].error(e.data.message)}))):2==a?(console.log("upda"),e.$httpApi.live_server_update(i).then((function(e){"0"!=e.data.code&&n["Message"].error(e.data.message)}))):3==a&&(console.log("del"),e.$httpApi.live_server_del(i).then((function(e){"0"!=e.data.code&&n["Message"].error(e.data.message)})))}))},clickTreeFunc:function(e){this.btnDisable.liveBtn.init=this.btnDisable.liveBtn.del=this.btnDisable.liveBtn.reName=e.id<1e3,this.treeCurrent=e;var t=this;t.liveInfoTableData=new Array,t.$refs.liveTb.initCurrentData(t.liveInfoTableData),this.$httpApi.live_list().then((function(a){if("0"==a.data.code){var i=a.data.dataList;i&&i.forEach((function(a){a.name==e.label&&(t.liveInfoTableData=a.dataList,t.$refs.liveTb.initCurrentData(t.liveInfoTableData))}))}}))},liveTbChanged:function(e){this.btnDisable.liveBtn.save=0==e},serverTbChaned:function(e){this.btnDisable.serverBtn.save=0==e},serverRowClick:function(e){this.btnDisable.serverBtn.del=void 0==e}},mounted:function(){var e=this;this.$httpApi.lineInfo("0").then((function(t){"0"==t.data.code&&(e.lineList=t.data.dataList)})),this.$httpApi.live_list().then((function(t){if("0"==t.data.code){var a=3e3,i=t.data.dataList;i&&i.forEach((function(t){e.treeData[0].children.push({label:t.name,id:a++,tableData:t.dataList}),3001==a&&(console.log(e.treeData[0].children[0].id),e.$refs.tree.setCurrentKey(e.treeData[0].children[0].id))}))}})),this.$httpApi.live_server_list().then((function(t){"0"==t.data.code?(e.liveListTableData=t.data.dataList,e.$refs.serverTb.initCurrentData(e.liveListTableData)):n["Message"].error(t.data.message)}))}},d=o,c=(a("dd50"),a("2877")),v=Object(c["a"])(d,i,l,!1,null,"7bdb9cf5",null);t["default"]=v.exports}}]);
//# sourceMappingURL=chunk-322fdf18.c29ad53d.js.map